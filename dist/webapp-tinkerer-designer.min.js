!function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=n(t);function o(){}function i(t){return t()}function s(){return Object.create(null)}function a(t){t.forEach(i)}function l(t){return"function"==typeof t}function u(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e,n){t.$$.on_destroy.push(function(t,...e){if(null==t)return o;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}(e,n))}let h,d=!1;function f(t,e,n,r){for(;t<e;){const o=t+(e-t>>1);n(o)<=r?t=o+1:e=o}return t}function p(t,e){d?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let o=0;for(let t=0;t<e.length;t++){const i=f(1,o+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[i]+1;const s=i+1;n[s]=t,o=Math.max(s,o)}const i=[],s=[];let a=e.length-1;for(let t=n[o]+1;0!=t;t=r[t-1]){for(i.push(e[t-1]);a>=t;a--)s.push(e[a]);a--}for(;a>=0;a--)s.push(e[a]);i.reverse(),s.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<s.length;e++){for(;n<i.length&&s[e].claim_order>=i[n].claim_order;)n++;const r=n<i.length?i[n]:null;t.insertBefore(s[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function _(t,e,n){d&&!n?p(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function g(t){t.parentNode.removeChild(t)}function m(){return t="",document.createTextNode(t);var t}function v(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function y(t){h=t}const b=[],E=[],D=[],S=[],x=Promise.resolve();let T=!1;function $(t){D.push(t)}let P=!1;const w=new Set;function O(){if(!P){P=!0;do{for(let t=0;t<b.length;t+=1){const e=b[t];y(e),A(e.$$)}for(y(null),b.length=0;E.length;)E.pop()();for(let t=0;t<D.length;t+=1){const e=D[t];w.has(e)||(w.add(e),e())}D.length=0}while(b.length);for(;S.length;)S.pop()();T=!1,P=!1,w.clear()}}function A(t){if(null!==t.fragment){t.update(),a(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach($)}}const M=new Set;let I;function H(t,e){t&&t.i&&(M.delete(t),t.i(e))}function C(t,e,n,r){if(t&&t.o){if(M.has(t))return;M.add(t),I.c.push((()=>{M.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function L(t,e){C(t,1,1,(()=>{e.delete(t.key)}))}function k(t,e,n,r){const{fragment:o,on_mount:s,on_destroy:u,after_update:c}=t.$$;o&&o.m(e,n),r||$((()=>{const e=s.map(i).filter(l);u?u.push(...e):a(e),t.$$.on_mount=[]})),c.forEach($)}function R(t,e){const n=t.$$;null!==n.fragment&&(a(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function N(t,e){-1===t.$$.dirty[0]&&(b.push(t),T||(T=!0,x.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(t,e,n,r,i,l,u=[-1]){const c=h;y(t);const f=t.$$={fragment:null,ctx:null,props:l,update:o,not_equal:i,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:e.context||[]),callbacks:s(),dirty:u,skip_bound:!1};let p=!1;if(f.ctx=n?n(t,e.props||{},((e,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&i(f.ctx[e],f.ctx[e]=o)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](o),p&&N(t,e)),n})):[],f.update(),p=!0,a(f.before_update),f.fragment=!!r&&r(f.ctx),e.target){if(e.hydrate){d=!0;const t=function(t){return Array.from(t.childNodes)}(e.target);f.fragment&&f.fragment.l(t),t.forEach(g)}else f.fragment&&f.fragment.c();e.intro&&H(t.$$.fragment),k(t,e.target,e.anchor,e.customElement),d=!1,O()}y(c)}function Y(t,e){if(t===e)return!1;var n=typeof t;if(n!==typeof e)return!0;switch(n){case"undefined":case"boolean":case"string":case"function":return!0;case"number":return isNaN(t)!==isNaN(e)||Math.abs(t-e)>Number.EPSILON;case"object":return null==t||(null==e||(Array.isArray(t)?function(t,e){if(!Array.isArray(e))return!0;if(t.length!==e.length)return!0;for(var n=0,r=t.length;n<r;n++)if(Y(t[n],e[n]))return!0;return!1}(t,e):function(t,e){if(Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!0;for(var n in t)if(!(n in e))return!0;for(var n in e){if(!(n in t))return!0;if(Y(t[n],e[n]))return!0}return!1}(t,e)));default:return!0}return!0}var j;!function(t){var e=function(){function t(){this._dropEffect="move",this._effectAllowed="all",this._data={}}return Object.defineProperty(t.prototype,"dropEffect",{enumerable:!0,configurable:!0,get:function(){return this._dropEffect},set:function(t){this._dropEffect=t}}),Object.defineProperty(t.prototype,"effectAllowed",{enumerable:!0,configurable:!0,get:function(){return this._effectAllowed},set:function(t){this._effectAllowed=t}}),Object.defineProperty(t.prototype,"types",{enumerable:!0,configurable:!0,get:function(){return Object.keys(this._data)}}),t.prototype.clearData=function(t){null==t?this._data={}:delete this._data[t.toLowerCase()]},t.prototype.getData=function(t){return this._data[t.toLowerCase()]||""},t.prototype.setData=function(t,e){this._data[t.toLowerCase()]=e},t.prototype.setDragImage=function(t,e,r){var o=n._instance;o._imgCustom=t,o._imgOffset={x:e,y:r}},t}();t.DataTransfer=e;var n=function(){function t(){if(this._lastClick=0,null!=n&&null!=n._instance)throw new Error("DragDropTouch instance already created.");var t=!1;if(document.addEventListener("test",(function(){}),{get passive(){return t=!0,!0}}),navigator.maxTouchPoints>0){var e=this._touchstart.bind(this),r=this._touchmove.bind(this),o=this._touchend.bind(this),i=!!t&&{passive:!1,capture:!1};document.addEventListener("touchstart",e,i),document.addEventListener("touchmove",r,i),document.addEventListener("touchend",o),document.addEventListener("touchcancel",o)}}t.getInstance=function(){return n._instance},t.prototype._touchstart=function(t){var e=this;if(this._shouldHandle(t)){if(Date.now()-this._lastClick<n._DBLCLICK&&this._dispatchEvent(t,"dblclick",t.target))return t.preventDefault(),void this._reset();this._reset();var r=this._closestDraggable(t.target);null!=r&&(this._dispatchEvent(t,"mousemove",t.target)||this._dispatchEvent(t,"mousedown",t.target)||(this._dragSource=r,this._ptDown=this._getPoint(t),this._lastTouch=t,t.preventDefault(),setTimeout((function(){e._dragSource===r&&null==e._img&&e._dispatchEvent(t,"contextmenu",r)&&e._reset()}),n._CTXMENU),n._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout((function(){e._isDragEnabled=!0,e._touchmove(t)}),n._PRESSHOLDAWAIT))))}},t.prototype._touchmove=function(t){if(this._shouldCancelPressHoldMove(t))this._reset();else if(this._shouldHandleMove(t)||this._shouldHandlePressHoldMove(t)){var e=this._getTarget(t);if(this._dispatchEvent(t,"mousemove",e))return this._lastTouch=t,void t.preventDefault();var n=this._getPoint(this._lastTouch,!0),r=this._getPoint(t,!0);this._lastMovementX=r.x-n.x,this._lastMovementY=r.y-n.y;var o={movementX:this._lastMovementX,movementY:this._lastMovementY};this._dragSource&&null==this._img&&this._shouldStartDragging(t)&&(this._dispatchEvent(t,"dragstart",this._dragSource,o),this._createImage(t),this._dispatchEvent(t,"dragenter",e,o)),null!=this._img&&(this._lastTouch=t,t.preventDefault(),this._dispatchEvent(t,"drag",this._dragSource,o),e!=this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget,o),this._dispatchEvent(t,"dragenter",e,o),this._lastTarget=e),this._moveImage(t),this._isDropZone=this._dispatchEvent(t,"dragover",e,o))}},t.prototype._touchend=function(t){if(this._shouldHandle(t)){if(this._dispatchEvent(this._lastTouch,"mouseup",t.target))return void t.preventDefault();if(null==this._img&&(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",t.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource){var e={movementX:this._lastMovementX,movementY:this._lastMovementY};t.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget,e),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource,e),this._reset()}}},t.prototype._shouldHandle=function(t){return null!=t&&!t.defaultPrevented&&null!=t.touches&&t.touches.length<2},t.prototype._shouldHandleMove=function(t){return!n._ISPRESSHOLDMODE&&this._shouldHandle(t)},t.prototype._shouldHandlePressHoldMove=function(t){return n._ISPRESSHOLDMODE&&this._isDragEnabled&&null!=t&&null!=t.touches&&t.touches.length>0},t.prototype._shouldCancelPressHoldMove=function(t){return n._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(t)>n._PRESSHOLDMARGIN},t.prototype._shouldStartDragging=function(t){var e=this._getDelta(t);return e>n._THRESHOLD||n._ISPRESSHOLDMODE&&e>=n._PRESSHOLDTHRESHOLD},t.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new e,this._lastMovementX=0,this._lastMovementY=0,clearInterval(this._pressHoldInterval)},t.prototype._getPoint=function(t,e){if(null!=t&&null!=t.touches&&t.touches.length>0){var n=t.touches[0];return{x:e?n.pageX:n.clientX,y:e?n.pageY:n.clientY}}var r=t;return{x:e?r.pageX:r.clientX,y:e?r.pageY:r.clientY}},t.prototype._getDelta=function(t){if(n._ISPRESSHOLDMODE&&!this._ptDown)return 0;var e=this._getPoint(t);return Math.abs(e.x-this._ptDown.x)+Math.abs(e.y-this._ptDown.y)},t.prototype._getTarget=function(t){for(var e=this._getPoint(t),n=document.elementFromPoint(e.x,e.y);null!=n&&"none"==getComputedStyle(n).pointerEvents;)n=n.parentElement;return n},t.prototype._createImage=function(t){null!=this._img&&this._destroyImage();var e=this._imgCustom||this._dragSource;if(this._img=e.cloneNode(!0),this._copyStyle(e,this._img),this._img.style.top=this._img.style.left="-9999px",null==this._imgCustom){var r=e.getBoundingClientRect(),o=this._getPoint(t);this._imgOffset={x:o.x-r.left,y:o.y-r.top},this._img.style.opacity=n._OPACITY.toString()}this._moveImage(t),document.body.appendChild(this._img)},t.prototype._destroyImage=function(){null!=this._img&&null!=this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},t.prototype._moveImage=function(t){var e=this;requestAnimationFrame((function(){if(null!=e._img){var n=e._getPoint(t,!0),r=e._img.style;r.position="absolute",r.pointerEvents="none",r.zIndex="999999",r.left=Math.round(n.x-e._imgOffset.x)+"px",r.top=Math.round(n.y-e._imgOffset.y)+"px"}}))},t.prototype._copyProps=function(t,e,n){for(var r=0;r<n.length;r++){var o=n[r];t[o]=e[o]}},t.prototype._copyStyle=function(t,e){if(n._rmvAtts.forEach((function(t){e.removeAttribute(t)})),t instanceof HTMLCanvasElement){var r=t,o=e;o.width=r.width,o.height=r.height,o.getContext("2d").drawImage(r,0,0)}for(var i=getComputedStyle(t),s=0;s<i.length;s++){var a=i[s];a.indexOf("transition")<0&&(e.style[a]=i[a])}e.style.pointerEvents="none";for(s=0;s<t.children.length;s++)this._copyStyle(t.children[s],e.children[s])},t.prototype._dispatchEvent=function(t,e,r,o){if(null!=t&&null!=r){var i=document.createEvent("Event"),s=null!=t.touches?t.touches[0]:t;return i.initEvent(e,!0,!0),i.button=0,i.which=i.buttons=1,this._copyProps(i,t,n._kbdProps),this._copyProps(i,s,n._ptProps),i.dataTransfer=this._dataTransfer,null!=o&&(i.movementX=o.movementX,i.movementY=o.movementY),r.dispatchEvent(i),i.defaultPrevented}return!1},t.prototype._closestDraggable=function(t){for(;t;t=t.parentElement)if(t.hasAttribute("draggable")&&t.getAttribute("draggable"))return t;return null};var r=new t;return r._instance=r,r}();t.DragDropTouch=n;var r=j.DragDropTouch;r._THRESHOLD=5,r._OPACITY=.5,r._DBLCLICK=500,r._CTXMENU=900,r._ISPRESSHOLDMODE=!1,r._PRESSHOLDAWAIT=400,r._PRESSHOLDMARGIN=25,r._PRESSHOLDTHRESHOLD=0,r._rmvAtts="id,class,style,draggable".split(","),r._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),r._ptProps="pageX,pageY,clientX,clientY,screenX,screenY,offsetX,offsetY".split(",")}(j||(j={})),j.DragDropTouch;const B=[];const W=function(t,e=o){let n;const r=[];function i(e){if(u(t,e)&&(t=e,n)){const e=!B.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),B.push(n,t)}if(e){for(let t=0;t<B.length;t+=2)B[t][0](B[t+1]);B.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(s,a=o){const l=[s,a];return r.push(l),1===r.length&&(n=e(i)||o),s(t),()=>{const t=r.indexOf(l);-1!==t&&r.splice(t,1),0===r.length&&(n(),n=null)}}}}([]);function F(t,e,n){const r=t.slice();return r[7]=e[n],r}function K(t,e){let n,o,i;return o=new r.default({props:{Applet:e[7]}}),{key:t,first:null,c(){var t;n=m(),(t=o.$$.fragment)&&t.c(),this.first=n},m(t,e){_(t,n,e),k(o,t,e),i=!0},p(t,n){e=t;const r={};1&n&&(r.Applet=e[7]),o.$set(r)},i(t){i||(H(o.$$.fragment,t),i=!0)},o(t){C(o.$$.fragment,t),i=!1},d(t){t&&g(n),R(o,t)}}}function q(t){let e,n,r=[],o=new Map,i=t[0];const s=t=>t[7].uniqueId;for(let e=0;e<i.length;e+=1){let n=F(t,i,e),a=s(n);o.set(a,r[e]=K(a,n))}return{c(){var t,n,o,i;t="div",e=document.createElement(t);for(let t=0;t<r.length;t+=1)r[t].c();n=e,o="id",null==(i="webapp-tinkerer-designer")?n.removeAttribute(o):n.getAttribute(o)!==i&&n.setAttribute(o,i),v(e,"display","block"),v(e,"position","absolute"),v(e,"left","0px"),v(e,"top","0px"),v(e,"width","0px"),v(e,"height","0px"),v(e,"overflow","visible"),v(e,"pointer-events","none"),v(e,"margin","0px"),v(e,"padding","0px"),v(e,"border","none"),v(e,"background","transparent")},m(t,o){_(t,e,o);for(let t=0;t<r.length;t+=1)r[t].m(e,null);n=!0},p(t,[n]){1&n&&(i=t[0],I={r:0,c:[],p:I},r=function(t,e,n,r,o,i,s,a,l,u,c,h){let d=t.length,f=i.length,p=d;const _={};for(;p--;)_[t[p].key]=p;const g=[],m=new Map,v=new Map;for(p=f;p--;){const t=h(o,i,p),a=n(t);let l=s.get(a);l?r&&l.p(t,e):(l=u(a,t),l.c()),m.set(a,g[p]=l),a in _&&v.set(a,Math.abs(p-_[a]))}const y=new Set,b=new Set;function E(t){H(t,1),t.m(a,c),s.set(t.key,t),c=t.first,f--}for(;d&&f;){const e=g[f-1],n=t[d-1],r=e.key,o=n.key;e===n?(c=e.first,d--,f--):m.has(o)?!s.has(r)||y.has(r)?E(e):b.has(o)?d--:v.get(r)>v.get(o)?(b.add(r),E(e)):(y.add(o),d--):(l(n,s),d--)}for(;d--;){const e=t[d];m.has(e.key)||l(e,s)}for(;f;)E(g[f-1]);return g}(r,n,s,1,t,i,o,e,L,K,null,F),I.r||a(I.c),I=I.p)},i(t){if(!n){for(let t=0;t<i.length;t+=1)H(r[t]);n=!0}},o(t){for(let t=0;t<r.length;t+=1)C(r[t]);n=!1},d(t){t&&g(e);for(let t=0;t<r.length;t+=1)r[t].d()}}}function V(t,e,n,r,o){}function Z(t){return!1}function z(t,n,r){let o;c(t,W,(t=>r(0,o=t)));const i=Function("return this")(),s=i.WAT;if("function"!=typeof(null==s?void 0:s.ready))throw window.alert('"WebApp Tinkerer" not found\n\nThe WAT Designer needs the WAT Runtime to be loaded first'),new Error('MissingDependency: "WAT" not found');return s.ready((()=>{s.registerDesigner({startDesigning:V,inhibitsEventsFrom:Z}),console.log("WAD is running")})),s.ready((()=>{setInterval((()=>{let t=e.AppletPeersInDocument().map((t=>e.VisualForElement(t))).filter((t=>t.mayBeDesigned));Y(t,o)&&W.set(t)}),300)})),[o,"0.1.0",i,V,Z]}!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}("[draggable]{-webkit-touch-callout:none;-ms-touch-action:none;touch-action:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}",{insertAt:"top"});new class extends class{$destroy(){R(this,1),this.$destroy=o}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),X(this,t,z,q,u,{Version:1,global:2,startDesigning:3,inhibitsEventsFrom:4})}get Version(){return this.$$.ctx[1]}get global(){return this.$$.ctx[2]}get startDesigning(){return V}get inhibitsEventsFrom(){return Z}}({target:document.body})}(DesignerButton,WAT);
//# sourceMappingURL=webapp-tinkerer-designer.min.js.map
